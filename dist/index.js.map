{"version":3,"file":"index.js","sources":["../src/ChangeNotifier.js","../src/Provider.js","../src/useChange.js"],"sourcesContent":["export class ChangeNotifier {\n  _listeners = []\n\n  addListener(listener) {\n    this._listeners.push(listener)\n  }\n\n  removeListener(listener) {\n    const index = this._listeners.findIndex(l => l === listener)\n    if (index !== -1) {\n      this._listeners.splice(index, 1)\n    }\n  }\n\n  notifyListeners() {\n    this._listeners.forEach(l => l())\n  }\n\n  get hasListeners() {\n    return this._listeners.length > 0\n  }\n}","import React, { useContext } from 'react';\n\nconst ProvidersContext = React.createContext()\n\nexport const MultiProvider = ({ children, providers }) =>\n  <ProvidersContext.Provider value={providers}>\n    {children}\n  </ProvidersContext.Provider>\n\nconst isString = (type) => typeof type === String\nconst isFunction = (type) => typeof type === 'function'\n\nexport const useProvider = (name) => {\n  const providers = useContext(ProvidersContext) ?? []\n  if (!(name in providers)) {\n    throw new TypeError(`${name} provider not found, use MultiProvider to declare one`);\n  }\n  const provider = isFunction(providers[name]) ? providers[name]() : providers[name]\n  providers[name] = provider\n  return provider\n}","import { useState, useEffect } from 'react';\nimport { ChangeNotifier } from './ChangeNotifier';\n\nexport const useChange = (provider, key) => {\n  if (!provider) {\n    throw new TypeError(`provider is not defined, useChange(provider, 'key')`);\n  }\n  if (typeof provider === ChangeNotifier) {\n    throw new TypeError(`provider is not ChangeNotifier`);\n  }\n  if (!(key in provider)) {\n    throw new TypeError(`key ${key} is not found in provider, useChange(provider, 'key')`);\n  }\n  const [value, setValue] = useState(provider[key])\n  useEffect(() => {\n    const update = () => setValue(provider[key])\n    provider.addListener(update)\n    return () => {\n      provider.removeListener(update)\n    }\n  }, [])\n  return value\n}"],"names":["ChangeNotifier","listener","_listeners","push","index","findIndex","l","splice","forEach","length","ProvidersContext","React","createContext","MultiProvider","children","providers","isFunction","type","useProvider","name","useContext","TypeError","provider","useChange","key","useState","value","setValue","useEffect","update","addListener","removeListener"],"mappings":"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"}